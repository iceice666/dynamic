@import 'tailwindcss';
@plugin '@tailwindcss/typography';

@theme {
  --color-background: oklch(99% 0 0);
  --color-foreground: oklch(10% 0 0);
  --color-muted: oklch(45% 0 0);
  --color-muted-bg: oklch(95% 0 0);
  --color-border: oklch(88% 0 0);
  --color-accent: oklch(55% 0.18 var(--accent-hue, 255));
  --color-accent-fg: oklch(99% 0 0);
}

html.dark {
  --color-background: oklch(10% 0 0);
  --color-foreground: oklch(97% 0 0);
  --color-muted: oklch(60% 0 0);
  --color-muted-bg: oklch(17% 0 0);
  --color-border: oklch(25% 0 0);
  --color-accent: oklch(70% 0.15 var(--accent-hue, 255));
  --color-accent-fg: oklch(10% 0 0);
  --shiki-dark: oklch(97% 0 0);
}

body {
  background-color: var(--color-background);
  color: var(--color-foreground);
  transition:
    background-color 0.2s ease,
    color 0.2s ease;
}

/* Flip Tailwind Typography prose variables for dark mode */
html.dark .prose {
  --tw-prose-body: var(--color-foreground);
  --tw-prose-headings: var(--color-foreground);
  --tw-prose-lead: var(--color-muted);
  --tw-prose-links: var(--color-accent);
  --tw-prose-bold: var(--color-foreground);
  --tw-prose-counters: var(--color-muted);
  --tw-prose-bullets: var(--color-muted);
  --tw-prose-hr: var(--color-border);
  --tw-prose-quotes: var(--color-foreground);
  --tw-prose-quote-borders: var(--color-accent);
  --tw-prose-captions: var(--color-muted);
  --tw-prose-code: var(--color-foreground);
  --tw-prose-pre-code: var(--color-foreground);
  --tw-prose-pre-bg: var(--color-muted-bg);
  --tw-prose-th-borders: var(--color-border);
  --tw-prose-td-borders: var(--color-border);
}

/* Register accent-hue as an animatable property */
@property --accent-hue {
  syntax: '<number>';
  initial-value: 255;
  inherits: true;
}

/* Rainbow mode animation - animates hue without moving the slider */
html.rainbow-active {
  animation: rainbow-hue var(--rainbow-duration, 10s) linear infinite;
}

@keyframes rainbow-hue {
  from {
    --accent-hue: 0;
  }
  to {
    --accent-hue: 360;
  }
}

/* i18n: show/hide elements based on data-lang attribute */
[data-i18n-en],
[data-i18n-zh-tw] {
  display: none;
}

html[data-lang='en'] [data-i18n-en],
html:not([data-lang]) [data-i18n-en] {
  display: contents;
}

html[data-lang='zh-tw'] [data-i18n-zh-tw] {
  display: contents;
}

/* Search input styles (global because scoped styles don't pierce React islands) */
.search-input {
  width: 100%;
  padding: 0.625rem 0.875rem;
  border: 1px solid var(--color-border);
  border-radius: 0.5rem;
  background: var(--color-background);
  color: var(--color-foreground);
  font-size: 0.9375rem;
  outline: none;
  transition:
    border-color 0.15s ease,
    box-shadow 0.15s ease;
}

.search-input::placeholder {
  color: var(--color-muted);
}

.search-input:focus {
  border-color: var(--color-accent);
  box-shadow: 0 0 0 2px oklch(from var(--color-accent) l c h / 25%);
}

/* ThemeButton slider styles */
.hue-slider {
  -webkit-appearance: none;
  appearance: none;
  height: 8px;
  border-radius: 4px;
  background: linear-gradient(
    to right,
    hsl(0, 80%, 50%),
    hsl(60, 80%, 50%),
    hsl(120, 80%, 50%),
    hsl(180, 80%, 50%),
    hsl(240, 80%, 50%),
    hsl(300, 80%, 50%),
    hsl(360, 80%, 50%)
  );
  cursor: pointer;
}

.hue-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: white;
  border: 2px solid var(--color-border);
  box-shadow: 0 1px 3px oklch(0% 0 0 / 20%);
}

.hue-slider::-moz-range-thumb {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: white;
  border: 2px solid var(--color-border);
  box-shadow: 0 1px 3px oklch(0% 0 0 / 20%);
}

.speed-slider {
  -webkit-appearance: none;
  appearance: none;
  height: 6px;
  border-radius: 3px;
  background: var(--color-muted-bg);
  cursor: pointer;
}

.speed-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--color-accent);
  cursor: pointer;
}

.speed-slider::-moz-range-thumb {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--color-accent);
  cursor: pointer;
}

/* Admonitions / Callouts */
.admonition {
  margin: 1.5rem 0;
  padding: 1rem 1.25rem;
  border-left: 4px solid;
  border-radius: 0.5rem;
  background: var(--color-muted-bg);
  position: relative;
}

.admonition::before {
  content: '';
  display: inline-block;
  width: 1.25rem;
  height: 1.25rem;
  margin-right: 0.5rem;
  vertical-align: -0.25rem;
  background-size: contain;
  background-repeat: no-repeat;
  flex-shrink: 0;
}

.admonition > :first-child {
  margin-top: 0;
}

.admonition > :last-child {
  margin-bottom: 0;
}

/* Note (blue) */
.admonition-note {
  border-left-color: oklch(60% 0.15 250);
  background: oklch(95% 0.02 250);
}

.admonition-note::before {
  content: '‚ÑπÔ∏è';
  filter: grayscale(0);
}

html.dark .admonition-note {
  border-left-color: oklch(65% 0.15 250);
  background: oklch(20% 0.03 250);
}

/* Tip (green) */
.admonition-tip {
  border-left-color: oklch(60% 0.15 150);
  background: oklch(95% 0.02 150);
}

.admonition-tip::before {
  content: 'üí°';
  filter: grayscale(0);
}

html.dark .admonition-tip {
  border-left-color: oklch(65% 0.15 150);
  background: oklch(20% 0.03 150);
}

/* Warning (yellow/orange) */
.admonition-warning {
  border-left-color: oklch(65% 0.15 60);
  background: oklch(95% 0.02 60);
}

.admonition-warning::before {
  content: '‚ö†Ô∏è';
  filter: grayscale(0);
}

html.dark .admonition-warning {
  border-left-color: oklch(70% 0.15 60);
  background: oklch(20% 0.03 60);
}

/* Danger (red) */
.admonition-danger {
  border-left-color: oklch(60% 0.18 25);
  background: oklch(95% 0.02 25);
}

.admonition-danger::before {
  content: 'üö®';
  filter: grayscale(0);
}

html.dark .admonition-danger {
  border-left-color: oklch(65% 0.18 25);
  background: oklch(20% 0.03 25);
}

/* Typography integration - ensure admonitions work well within prose */
.prose .admonition {
  font-size: 0.9375rem;
}

.prose .admonition p {
  margin: 0.5rem 0;
}

.prose .admonition p:first-of-type {
  margin-top: 0;
}

.prose .admonition p:last-of-type {
  margin-bottom: 0;
}
