---
import { t, getLocaleLink } from '$/i18n';
import { formatDate } from '$/utils';
import ArticleViewCount from '$/components/widgets/ArticleViewCount';

interface Props {
  publishedAt: Date;
  tags: string[];
  slug: string;
}

const { publishedAt, tags, slug } = Astro.props;
const { locale } = Astro.locals;
const postPath = `/posts/${slug}/`;
---

<article class="card relative">
  <a href={postPath} class="absolute inset-0 rounded-[inherit]" aria-label={t(locale, 'post_label')}
  ></a>
  <div class="label-uppercase">
    {t(locale, 'post_label')}
  </div>

  <div class="prose prose-sm text-foreground max-w-none">
    <slot />
  </div>

  <div class="relative z-10 flex flex-wrap items-center gap-2">
    <div class="flex flex-wrap gap-1.5">
      {
        tags.map((tag) => (
          <a href={`${getLocaleLink('/search', locale)}?q=%23${tag}`} class="tag-link">
            #{tag}
          </a>
        ))
      }
    </div>
    <ArticleViewCount client:idle path={postPath} />
    <div class="flex-1"></div>
    <time class="text-muted text-xs" datetime={publishedAt.toISOString()}
      >{formatDate(publishedAt)}</time
    >
  </div>
</article>
