---
import LeftNavList from './LeftNavList';
import TOCWidget from '$/components/toc/TOCWidget.astro';
import AuthorBio from '$/components/cards/AuthorBio';

interface Props {
  currentPath: string;
  toc?: { depth: number; slug: string; text: string }[];
}

const { currentPath, toc } = Astro.props;
const hasToc = toc && toc.length > 0;
---

<nav class="left-nav flex h-full flex-col gap-4 p-4">
  <div class="left-nav-primary flex flex-col gap-4">
    <LeftNavList client:load transition:persist currentPath={currentPath} />
  </div>

  {
    hasToc && (
      <div class="left-toc-wrapper flex min-h-0 flex-1 flex-col gap-4">
        <hr class="border-border" />
        <div class="min-h-0 flex-1 overflow-y-auto">
          <TOCWidget headings={toc} />
        </div>
      </div>
    )
  }

  {!hasToc && <div class="flex-1" />}
  {hasToc && <div class="left-toc-spacer flex-1" />}

  <hr class="border-border" />

  <div transition:persist>
    <AuthorBio client:load />
  </div>
</nav>

<style>
  .left-toc-spacer {
    display: none;
  }

  @media (min-width: 1201px) {
    .left-toc-wrapper {
      display: none;
    }

    .left-toc-spacer {
      display: block;
    }
  }
</style>
