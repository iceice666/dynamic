---
import BaseLayout from '../../layouts/BaseLayout.astro';
import I18nText from '../../components/I18nText.astro';
import { getCollection, render } from 'astro:content';
import { ui } from '../../i18n/ui';
import { entrySlug } from '../../utils';

export async function getStaticPaths() {
  const posts = await getCollection('posts', ({ data }) => !data.draft);
  return posts.map((entry) => ({
    params: { id: entrySlug(entry.id) },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);
---

<BaseLayout title={ui.en.post_label}>
  <article class="prose prose-lg max-w-none">
    <div
      class="not-prose text-muted mb-4 text-[0.6875rem] font-semibold tracking-[0.08em] uppercase"
    >
      <I18nText k="post_label" />
    </div>
    <Content />
    <div class="not-prose mt-4 flex flex-wrap gap-1.5">
      {
        entry.data.tags.map((tag) => (
          <a href={`/tags/${tag}`} class="text-accent text-xs no-underline hover:opacity-75">
            #{tag}
          </a>
        ))
      }
    </div>
  </article>
</BaseLayout>
